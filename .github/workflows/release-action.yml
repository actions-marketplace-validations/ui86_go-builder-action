name: Publish Action

on:
  push:
    branches:
      - main
    paths:
      - 'action.yml'
      - 'Dockerfile'
      - 'entrypoint.sh'

jobs:
  tag:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      # 自动更新 'v1' 标签指向最新的 commit
      # 这样用户使用 @v1 时永远是最新代码，不需要改版本号
      - uses: actions/git-tag-action@1.1.2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          CUSTOM_TAG: v1
          FORCE_TAG: true